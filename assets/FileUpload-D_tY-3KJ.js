import{j as c}from"./jsx-runtime-qGIIFXMu.js";import{t as le,I as de,c as g}from"./tv-CIwtzMts.js";import{r as d}from"./index-CDs2tPxN.js";import{c as ce}from"./create-react-context-Dw26gLIP.js";import{c as O,p as f,s as F,a as pe,b as me,d as u,N as ue,o as D,v as ge,e as fe,z as h,f as _,g as Fe,r as Ie,A as Pe,E as Ne}from"./factory-CadeRpXq.js";import{c as C}from"./create-split-props-u5h9OPvL.js";import{c as he}from"./index-BzeP-DbB.js";import{u as ye,a as Ee}from"./use-locale-context-BgVInbo7.js";import{u as w}from"./use-event-eGuf5zsd.js";import{u as z}from"./use-field-context-Bl-xBte_.js";const[Ue,I]=O({name:"FileUploadContext",hookName:"useFileUploadContext",providerName:"<FileUploadProvider />"}),Re=e=>e.children(I()),S=d.forwardRef((e,r)=>{const t=I(),i=f(t.getDropzoneProps(),e);return c.jsx(F.div,{...i,ref:r})});S.displayName="FileUploadDropzone";const A=d.forwardRef((e,r)=>{const t=I(),i=f(t.getHiddenInputProps(),e),o=z();return c.jsx(F.input,{"aria-describedby":o==null?void 0:o.ariaDescribedby,...i,ref:r})});A.displayName="FileUploadHiddenInput";const[ve,v]=O({name:"FileUploadItemPropsContext",hookName:"useFileUploadItemPropsContext",providerName:"<FileUploadItemPropsProvider />"}),k=d.forwardRef((e,r)=>{const[t,i]=C()(e,["file"]),o=I(),a=f(o.getItemProps(t),i);return c.jsx(ve,{value:t,children:c.jsx(F.li,{...a,ref:r})})});k.displayName="FileUploadItem";const $=d.forwardRef((e,r)=>{const t=I(),i=v(),o=f(t.getItemDeleteTriggerProps(i),e);return c.jsx(F.button,{...o,ref:r})});$.displayName="FileUploadItemDeleteTrigger";const G=d.forwardRef((e,r)=>{const t=I(),i=f(t.getItemGroupProps(),e);return c.jsx(F.ul,{...i,ref:r})});G.displayName="FileUploadItemGroup";const M=d.forwardRef((e,r)=>{const{children:t,...i}=e,o=I(),a=v(),n=f(o.getItemNameProps(a),i);return c.jsx(F.div,{...n,ref:r,children:t||a.file.name})});M.displayName="FileUploadItemName";const H=d.forwardRef((e,r)=>{const t=I(),i=v(),o=f(t.getItemPreviewProps(i),e);return i.file.type.match(e.type??".*")?c.jsx(F.div,{...o,ref:r}):null});H.displayName="FileUploadItemPreview";const Z=d.forwardRef((e,r)=>{const[t,i]=d.useState(""),o=I(),a=v(),n=f(o.getItemPreviewImageProps({...a,url:t}),e);return d.useEffect(()=>{o.createFileUrl(a.file,p=>i(p))},[a,o]),c.jsx(F.img,{...n,ref:r})});Z.displayName="FileUploadItemPreviewImage";const V=d.forwardRef((e,r)=>{const{children:t,...i}=e,o=I(),a=v(),n=f(o.getItemSizeTextProps(a),i);return c.jsx(F.div,{...n,ref:r,children:t||o.getFileSize(a.file)})});V.displayName="FileUploadItemSizeText";const W=d.forwardRef((e,r)=>{const t=I(),i=f(t.getLabelProps(),e);return c.jsx(F.label,{...i,ref:r})});W.displayName="FileUploadLabel";function we(e){const r=new Map;return function(i,o){const a=i+(o?Object.entries(o).sort((p,s)=>p[0]<s[0]?-1:1).join():"");if(r.has(a))return r.get(a);let n=new e(i,o);return r.set(a,n),n}}var xe=we(Intl.NumberFormat);function be(e,r,t={}){return xe(r,t).format(e)}var De=["","kilo","mega","giga","tera"],Te=["","kilo","mega","giga","tera","peta"],Le=(e,r="en-US",t={})=>{if(isNaN(e))return"";if(e===0)return"0 B";const{unit:i="byte",unitDisplay:o="short"}=t,a=i==="bit"?De:Te,n=Math.max(0,Math.min(Math.floor(Math.log10(e)/3),a.length-1)),p=a[n]+i,s=o||"short",l=parseFloat((e/Math.pow(1e3,n)).toPrecision(3));return be(l,r,{style:"unit",unit:p,unitDisplay:s})};function je(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function Oe(e){return/^.*\.[\w]+$/.test(e)}var T=e=>je(e)||Oe(e);function _e(e){if(e)return typeof e=="string"?e:Array.isArray(e)?e.filter(T).join(","):Object.entries(e).reduce((r,[t,i])=>[...r,t,...i],[]).filter(T).join(",")}var Ce=(e,r)=>e.name===r.name&&e.size===r.size&&e.type===r.type,R=e=>e!=null;function ze(e,r,t){if(R(e.size))if(R(r)&&R(t)){if(e.size>t)return[!1,"FILE_TOO_LARGE"];if(e.size<r)return[!1,"FILE_TOO_SMALL"]}else{if(R(r)&&e.size<r)return[!1,"FILE_TOO_SMALL"];if(R(t)&&e.size>t)return[!1,"FILE_TOO_LARGE"]}return[!0,null]}function Se(e,r){if(e&&r){const t=Array.isArray(r)?r:r.split(","),i=e.name||"",o=(e.type||"").toLowerCase(),a=o.replace(/\/.*$/,"");return t.some(n=>{const p=n.trim().toLowerCase();return p.charAt(0)==="."?i.toLowerCase().endsWith(p):p.endsWith("/*")?a===p.replace(/\/.*$/,""):o===p})}return!0}function Ae(e,r){const t=e.type==="application/x-moz-file"||Se(e,r);return[t,t?null:"FILE_INVALID_TYPE"]}var ke=pe("file-upload").parts("root","dropzone","item","itemDeleteTrigger","itemGroup","itemName","itemPreview","itemPreviewImage","itemSizeText","label","trigger"),P=ke.build(),m=me({getRootId:e=>{var r;return((r=e.ids)==null?void 0:r.root)??`file:${e.id}`},getDropzoneId:e=>{var r;return((r=e.ids)==null?void 0:r.dropzone)??`file:${e.id}:dropzone`},getHiddenInputId:e=>{var r;return((r=e.ids)==null?void 0:r.hiddenInput)??`file:${e.id}:input`},getTriggerId:e=>{var r;return((r=e.ids)==null?void 0:r.trigger)??`file:${e.id}:trigger`},getLabelId:e=>{var r;return((r=e.ids)==null?void 0:r.label)??`file:${e.id}:label`},getItemId:(e,r)=>{var t,i;return((i=(t=e.ids)==null?void 0:t.item)==null?void 0:i.call(t,r))??`file:${e.id}:item:${r}`},getItemNameId:(e,r)=>{var t,i;return((i=(t=e.ids)==null?void 0:t.itemName)==null?void 0:i.call(t,r))??`file:${e.id}:item-name:${r}`},getItemSizeTextId:(e,r)=>{var t,i;return((i=(t=e.ids)==null?void 0:t.itemSizeText)==null?void 0:i.call(t,r))??`file:${e.id}:item-size:${r}`},getItemPreviewId:(e,r)=>{var t,i;return((i=(t=e.ids)==null?void 0:t.itemPreview)==null?void 0:i.call(t,r))??`file:${e.id}:item-preview:${r}`},getHiddenInputEl:e=>m.getById(e,m.getHiddenInputId(e)),getDropzoneEl:e=>m.getById(e,m.getDropzoneId(e))});function L(e){return e.dataTransfer?e.dataTransfer.types.some(r=>r==="Files"||r==="application/x-moz-file"):!!e.target&&"files"in e.target}function q(e,r){return!e.multiple&&r>1?!1:!e.multiple&&r+e.acceptedFiles.length===2?!0:!(r+e.acceptedFiles.length>e.maxFiles)}function $e(e,r){const t=[],i=[];return r.forEach(o=>{var E;const[a,n]=Ae(o,e.acceptAttr),[p,s]=ze(o,e.minFileSize,e.maxFileSize),l=(E=e.validate)==null?void 0:E.call(e,o),y=l?l.length===0:!0;if(a&&p&&y)t.push(o);else{const b=[n,s];y||b.push(...l??[]),i.push({file:o,errors:b.filter(Boolean)})}}),q(e,t.length)||(t.forEach(o=>{i.push({file:o,errors:["TOO_MANY_FILES"]})}),t.splice(0)),{acceptedFiles:t,rejectedFiles:i}}function Ge(e,r,t){const i=e.context.disabled,o=e.context.allowDrop,a=e.context.translations,n=e.matches("dragging"),p=e.matches("focused")&&!i;return{dragging:n,focused:p,openFilePicker(){r("OPEN")},deleteFile(s){r({type:"FILE.DELETE",file:s})},acceptedFiles:e.context.acceptedFiles,rejectedFiles:e.context.rejectedFiles,setFiles(s){const l=s.length;r({type:"FILES.SET",files:s,count:l})},clearRejectedFiles(){r({type:"REJECTED_FILES.CLEAR"})},clearFiles(){r({type:"FILES.CLEAR"})},getFileSize(s){return Le(s.size,e.context.locale)},createFileUrl(s,l){const y=m.getWin(e.context),E=y.URL.createObjectURL(s);return l(E),()=>y.URL.revokeObjectURL(E)},getRootProps(){return t.element({...P.root.attrs,dir:e.context.dir,id:m.getRootId(e.context),"data-disabled":u(i),"data-dragging":u(n)})},getDropzoneProps(){return t.element({...P.dropzone.attrs,dir:e.context.dir,id:m.getDropzoneId(e.context),tabIndex:i?void 0:0,"aria-disabled":i,"aria-invalid":e.context.invalid,"data-invalid":u(e.context.invalid),"data-disabled":u(i),"data-dragging":u(n),onKeyDown(s){s.defaultPrevented||ue(s)&&(s.key!=="Enter"&&s.key!==" "||r({type:"DROPZONE.CLICK",src:"keydown"}))},onClick(s){s.currentTarget.localName==="label"&&s.preventDefault(),r("DROPZONE.CLICK")},onDragOver(s){if(!o)return;s.preventDefault(),s.stopPropagation();try{s.dataTransfer.dropEffect="copy"}catch{}if(!L(s))return;const y=s.dataTransfer.items.length;r({type:"DROPZONE.DRAG_OVER",count:y})},onDragLeave(s){!o||i||D(s.currentTarget,s.relatedTarget)||r({type:"DROPZONE.DRAG_LEAVE"})},onDrop(s){o&&(s.preventDefault(),s.stopPropagation());const l=L(s);i||!l||r({type:"DROPZONE.DROP",files:Array.from(s.dataTransfer.files)})},onFocus(){r("DROPZONE.FOCUS")},onBlur(){r("DROPZONE.BLUR")}})},getTriggerProps(){return t.button({...P.trigger.attrs,dir:e.context.dir,id:m.getTriggerId(e.context),disabled:i,"data-disabled":u(i),type:"button",onClick(s){i||(D(m.getDropzoneEl(e.context),s.currentTarget)&&s.stopPropagation(),r("OPEN"))}})},getHiddenInputProps(){return t.input({id:m.getHiddenInputId(e.context),tabIndex:-1,disabled:i,type:"file",required:e.context.required,capture:e.context.capture,name:e.context.name,accept:e.context.acceptAttr,webkitdirectory:e.context.capture?"":void 0,multiple:e.context.multiple||e.context.maxFiles>1,onClick(s){s.stopPropagation(),s.currentTarget.value=""},onChange(s){if(i)return;const{files:l}=s.currentTarget;r({type:"FILES.SET",files:l?Array.from(l):[]})},style:ge})},getItemGroupProps(){return t.element({...P.itemGroup.attrs,dir:e.context.dir,"data-disabled":u(i)})},getItemProps(s){const{file:l}=s;return t.element({...P.item.attrs,dir:e.context.dir,id:m.getItemId(e.context,l.name),"data-disabled":u(i)})},getItemNameProps(s){const{file:l}=s;return t.element({...P.itemName.attrs,dir:e.context.dir,id:m.getItemNameId(e.context,l.name),"data-disabled":u(i)})},getItemSizeTextProps(s){const{file:l}=s;return t.element({...P.itemSizeText.attrs,dir:e.context.dir,id:m.getItemSizeTextId(e.context,l.name),"data-disabled":u(i)})},getItemPreviewProps(s){const{file:l}=s;return t.element({...P.itemPreview.attrs,dir:e.context.dir,id:m.getItemPreviewId(e.context,l.name),"data-disabled":u(i)})},getItemPreviewImageProps(s){const{file:l,url:y}=s;if(!l.type.startsWith("image/"))throw new Error("Preview Image is only supported for image files");return t.img({...P.itemPreviewImage.attrs,alt:a.itemPreview(l),src:y,"data-disabled":u(i)})},getItemDeleteTriggerProps(s){const{file:l}=s;return t.button({...P.itemDeleteTrigger.attrs,dir:e.context.dir,type:"button",disabled:i,"data-disabled":u(i),"aria-label":a.deleteFile(l),onClick(){i||r({type:"FILE.DELETE",file:l})}})},getLabelProps(){return t.label({...P.label.attrs,dir:e.context.dir,id:m.getLabelId(e.context),htmlFor:m.getHiddenInputId(e.context),"data-disabled":u(i)})}}}var{not:j}=Fe;function Me(e){const r=he(e);return fe({id:"fileupload",initial:"idle",context:{minFileSize:0,maxFileSize:1/0,maxFiles:1,allowDrop:!0,...r,acceptedFiles:h([]),rejectedFiles:h([]),invalid:!1,translations:{itemPreview:t=>`preview of ${t.name}`,deleteFile:t=>`delete file ${t.name}`,...r.translations}},computed:{acceptAttr:t=>_e(t.accept),multiple:t=>t.maxFiles>1},on:{"FILES.SET":{actions:["setFilesFromEvent"]},"FILE.DELETE":{actions:["removeFile"]},"FILES.CLEAR":{actions:["clearFiles"]},"REJECTED_FILES.CLEAR":{actions:["clearRejectedFiles"]}},states:{idle:{on:{OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.FOCUS":"focused","DROPZONE.DRAG_OVER":[{guard:j("isWithinRange"),target:"dragging",actions:["setInvalid"]},{target:"dragging"}]}},focused:{on:{"DROPZONE.BLUR":"idle",OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.DRAG_OVER":[{guard:j("isWithinRange"),target:"dragging",actions:["setInvalid"]},{target:"dragging"}]}},dragging:{on:{"DROPZONE.DROP":{target:"idle",actions:["clearInvalid","setFilesFromEvent","syncInputElement"]},"DROPZONE.DRAG_LEAVE":{target:"idle",actions:["clearInvalid"]}}}}},{guards:{isWithinRange:(t,i)=>q(t,i.count)},actions:{syncInputElement(t){const i=m.getHiddenInputEl(t);if(!i)return;const o=m.getWin(t),a=new o.DataTransfer;t.acceptedFiles.forEach(n=>{a.items.add(n)}),i.files=a.files},openFilePicker(t){Ie(()=>{var i;(i=m.getHiddenInputEl(t))==null||i.click()})},setInvalid(t){t.invalid=!0},clearInvalid(t){t.invalid=!1},setFilesFromEvent(t,i){const o=$e(t,i.files),{acceptedFiles:a,rejectedFiles:n}=o;if(t.multiple){const p=h([...t.acceptedFiles,...a]);x.files(t,p,n);return}if(a.length){const p=h([a[0]]);x.files(t,p,n)}else n.length&&x.files(t,[],n)},removeFile(t,i){const o=t.acceptedFiles.filter(a=>a!==i.file);t.acceptedFiles=h(o),U.change(t)},clearRejectedFiles(t){t.rejectedFiles=h([]),U.change(t)},clearFiles(t){t.acceptedFiles=h([]),t.rejectedFiles=h([]),U.change(t)}},compareFns:{acceptedFiles:(t,i)=>t.length===i.length&&t.every((o,a)=>Ce(o,i[a]))}})}var U={change:e=>{var r;(r=e.onFileChange)==null||r.call(e,{acceptedFiles:e.acceptedFiles,rejectedFiles:e.rejectedFiles})},accept:e=>{var r;(r=e.onFileAccept)==null||r.call(e,{files:e.acceptedFiles})},reject:e=>{var r;(r=e.onFileReject)==null||r.call(e,{files:e.rejectedFiles})}},x={files:(e,r,t)=>{e.acceptedFiles=h(r),U.accept(e),t&&(e.rejectedFiles=h(t),U.reject(e)),U.change(e)}};_()(["accept","allowDrop","capture","dir","directory","disabled","getRootNode","id","ids","locale","maxFiles","maxFileSize","minFileSize","name","onFileAccept","onFileReject","onFileChange","required","translations","validate"]);_()(["file"]);const He=(e={})=>{const{getRootNode:r}=ye(),{dir:t}=Ee(),i=z(),o={id:d.useId(),ids:{label:i==null?void 0:i.ids.label,hiddenInput:i==null?void 0:i.ids.control},dir:t,disabled:i==null?void 0:i.disabled,required:i==null?void 0:i.required,getRootNode:r,...e},a={...o,onFileAccept:w(e.onFileAccept),onFileReject:w(e.onFileReject),onFileChange:w(e.onFileChange,{sync:!0})},[n,p]=Pe(Me(o),{context:a});return Ge(n,p,Ne)},B=d.forwardRef((e,r)=>{const[t,i]=C()(e,["accept","allowDrop","capture","directory","disabled","id","ids","locale","maxFiles","maxFileSize","minFileSize","name","onFileAccept","onFileChange","onFileReject","required","translations","validate"]),o=He(t),a=f(o.getRootProps(),i);return c.jsx(Ue,{value:o,children:c.jsx(F.div,{...a,ref:r})})});B.displayName="FileUploadRoot";const K=d.forwardRef((e,r)=>{const t=I(),i=f(t.getTriggerProps(),e);return c.jsx(F.button,{...i,ref:r})});K.displayName="FileUploadTrigger";const Ze=le({base:`${de.scope} fileUpload`,slots:{root:"trds-flex trds-flex-col trds-gap-4 trds-w-full",label:"trds-font-medium trds-text-sm",dropzone:"trds-flex trds-items-center trds-justify-center trds-flex-col trds-bg-white trds-rounded-md trds-border trds-border-boundary trds-min-h-xs trds-px-6 trds-py-4 trds-gap-3",trigger:"",item:'trds-grid trds-grid-cols-[auto_1fr_auto] [grid-template-areas:"preview_name_delete""preview_size_delete"] trds-bg-white trds-rounded-md trds-border trds-border-boundary trds-gap-x-3 trds-p-4 trds-animate-fade-in',itemGroup:"trds-flex trds-flex-col trds-gap-3",itemName:"trds-text-fg-title trds-font-medium trds-text-sm [grid-area:name]",itemSizeText:"trds-text-fg-description trds-text-sm [grid-area:size]",itemDeleteTrigger:"trds-self-start [grid-area:delete]",itemPreview:"[grid-area:preview]",itemPreviewImage:"trds-aspect-square trds-h-10 trds-w-10 trds-object-scale-down",hiddenInput:""}}),[Ve,N]=ce({name:"fileUpload",hookName:"useFileUploadContext",providerName:"FileUploadProvider",defaultValue:{classes:{}}}),J=d.forwardRef(function(e,r){const{placeholder:t,className:i,children:o,...a}=e,n=Ze(),p={classes:n};return c.jsx(Ve,{value:p,children:c.jsx(B,{ref:r,className:g(n.root(),i),...a,children:o})})});J.displayName="FileUpload.Root";const Y=d.forwardRef(function(e,r){const{className:t,children:i,...o}=e,{classes:a}=N();return c.jsx(A,{className:g(a.hiddenInput(),t),ref:r,...o,children:i})});Y.displayName="FileUpload.HiddenInput";const Q=d.forwardRef(function(e,r){const{className:t,children:i,...o}=e,{classes:a}=N();return c.jsx(S,{className:g(a.dropzone(),t),ref:r,...o,children:i})});Q.displayName="FileUpload.Dropzone";const X=d.forwardRef(function(e,r){const{className:t,children:i,...o}=e,{classes:a}=N();return c.jsx(W,{className:g(a.label(),t),ref:r,...o,children:i})});X.displayName="FileUpload.Label";const ee=d.forwardRef(function(e,r){const{className:t,children:i,...o}=e,{classes:a}=N();return c.jsx(K,{className:g(a.trigger(),t),ref:r,...o,children:i})});ee.displayName="FileUpload.Trigger";const te=d.forwardRef(function(e,r){const{className:t,children:i,...o}=e,{classes:a}=N();return c.jsx(G,{className:g(a.itemGroup(),t),ref:r,...o,children:i})});te.displayName="FileUpload.ItemGroup";const re=d.forwardRef(function(e,r){const{className:t,children:i,...o}=e,{classes:a}=N();return c.jsx(k,{className:g(a.item(),t),ref:r,...o,children:i})});re.displayName="FileUpload.Item";const ie=d.forwardRef(function(e,r){const{className:t,children:i,...o}=e,{classes:a}=N();return c.jsx(H,{className:g(a.itemPreview(),t),ref:r,...o,children:i})});ie.displayName="FileUpload.ItemPreview";const oe=d.forwardRef(function(e,r){const{className:t,children:i,...o}=e,{classes:a}=N();return c.jsx(Z,{className:g(a.itemPreviewImage(),t),ref:r,...o,children:i})});oe.displayName="FileUpload.ItemPreviewImage";const ae=d.forwardRef(function(e,r){const{className:t,children:i,...o}=e,{classes:a}=N();return c.jsx(M,{className:g(a.itemName(),t),ref:r,...o,children:i})});ae.displayName="FileUpload.ItemName";const se=d.forwardRef(function(e,r){const{className:t,children:i,...o}=e,{classes:a}=N();return c.jsx(V,{className:g(a.itemSizeText(),t),ref:r,...o,children:i})});se.displayName="FileUpload.ItemSizeText";const ne=d.forwardRef(function(e,r){const{className:t,children:i,...o}=e,{classes:a}=N();return c.jsx($,{className:g(a.itemDeleteTrigger(),t),ref:r,...o,children:i})});ne.displayName="FileUpload.ItemDeleteTrigger";const rt=Re;J.__docgenInfo={description:"",methods:[],displayName:"FileUpload.Root"};Q.__docgenInfo={description:"",methods:[],displayName:"FileUpload.Dropzone"};ee.__docgenInfo={description:"",methods:[],displayName:"FileUpload.Trigger"};X.__docgenInfo={description:"",methods:[],displayName:"FileUpload.Label"};te.__docgenInfo={description:"",methods:[],displayName:"FileUpload.ItemGroup"};re.__docgenInfo={description:"",methods:[],displayName:"FileUpload.Item"};ie.__docgenInfo={description:"",methods:[],displayName:"FileUpload.ItemPreview"};oe.__docgenInfo={description:"",methods:[],displayName:"FileUpload.ItemPreviewImage"};se.__docgenInfo={description:"",methods:[],displayName:"FileUpload.ItemSizeText"};ae.__docgenInfo={description:"",methods:[],displayName:"FileUpload.ItemName"};ne.__docgenInfo={description:"",methods:[],displayName:"FileUpload.ItemDeleteTrigger"};Y.__docgenInfo={description:"",methods:[],displayName:"FileUpload.HiddenInput"};export{rt as C,Q as D,Y as H,te as I,X as L,J as R,ee as T,re as a,ie as b,oe as c,se as d,ae as e,ne as f};
