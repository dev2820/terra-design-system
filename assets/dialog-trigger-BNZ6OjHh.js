import{j as l}from"./jsx-runtime-qGIIFXMu.js";import{c as f,m as c,h as u,a as D,b as v,e as I,n as y,r as P,f as T,T as k,A as F,E as b}from"./factory-BCO0_PXk.js";import{r as g}from"./index-CDs2tPxN.js";import{u as h,s as R,R as S}from"./render-strategy-BXR9Yyrn.js";import{u as C,a as O,P as w}from"./use-presence-BYwEg9-n.js";import{s as B}from"./split-presence-props-DcTE3k_W.js";import{a as L}from"./index-lb5DGD3A.js";import{a as N}from"./index-BTGRfmW-.js";import{p as j,c as $}from"./focus-trap.esm-PH5MDpJx.js";import{c as G}from"./index-B1LdDssV.js";import{u as K,a as M}from"./use-locale-context-CTaGYWMe.js";import{u as E}from"./use-event-eGuf5zsd.js";const[A,m]=f({name:"DialogContext",hookName:"useDialogContext",providerName:"<DialogProvider />"}),V=g.forwardRef((e,o)=>{const t=m(),n=h(),i=C({...n,present:t.open}),a=c(t.getBackdropProps(),i.getPresenceProps(o),e);return i.unmounted?null:l.jsx(u.div,{...a})});V.displayName="DialogBackdrop";const Z=g.forwardRef((e,o)=>{const t=m(),n=c(t.getCloseTriggerProps(),e);return l.jsx(u.button,{...n,ref:o})});Z.displayName="DialogCloseTrigger";const q=g.forwardRef((e,o)=>{const t=m(),n=O(),i=c(t.getContentProps(),n.getPresenceProps(o),e);return n.unmounted?null:l.jsx(u.div,{...i})});q.displayName="DialogContent";const H=g.forwardRef((e,o)=>{const t=m(),n=c(t.getDescriptionProps(),e);return l.jsx(u.div,{...n,ref:o})});H.displayName="DialogDescription";const W=g.forwardRef((e,o)=>{const t=m(),n=c(t.getPositionerProps(),e);return O().unmounted?null:l.jsx(u.div,{...n,ref:o})});W.displayName="DialogPositioner";var _=D("dialog").parts("trigger","backdrop","positioner","content","title","description","closeTrigger"),p=_.build(),r=v({getPositionerId:e=>{var o;return((o=e.ids)==null?void 0:o.positioner)??`dialog:${e.id}:positioner`},getBackdropId:e=>{var o;return((o=e.ids)==null?void 0:o.backdrop)??`dialog:${e.id}:backdrop`},getContentId:e=>{var o;return((o=e.ids)==null?void 0:o.content)??`dialog:${e.id}:content`},getTriggerId:e=>{var o;return((o=e.ids)==null?void 0:o.trigger)??`dialog:${e.id}:trigger`},getTitleId:e=>{var o;return((o=e.ids)==null?void 0:o.title)??`dialog:${e.id}:title`},getDescriptionId:e=>{var o;return((o=e.ids)==null?void 0:o.description)??`dialog:${e.id}:description`},getCloseTriggerId:e=>{var o;return((o=e.ids)==null?void 0:o.closeTrigger)??`dialog:${e.id}:close`},getContentEl:e=>r.getById(e,r.getContentId(e)),getPositionerEl:e=>r.getById(e,r.getPositionerId(e)),getBackdropEl:e=>r.getById(e,r.getBackdropId(e)),getTriggerEl:e=>r.getById(e,r.getTriggerId(e)),getTitleEl:e=>r.getById(e,r.getTitleId(e)),getDescriptionEl:e=>r.getById(e,r.getDescriptionId(e)),getCloseTriggerEl:e=>r.getById(e,r.getCloseTriggerId(e))});function J(e,o,t){const n=e.context["aria-label"],i=e.matches("open"),a=e.context.renderedElements;return{open:i,setOpen(s){s!==i&&o(s?"OPEN":"CLOSE")},getTriggerProps(){return t.button({...p.trigger.attrs,dir:e.context.dir,id:r.getTriggerId(e.context),"aria-haspopup":"dialog",type:"button","aria-expanded":i,"data-state":i?"open":"closed","aria-controls":r.getContentId(e.context),onClick(s){s.defaultPrevented||o("TOGGLE")}})},getBackdropProps(){return t.element({...p.backdrop.attrs,dir:e.context.dir,hidden:!i,id:r.getBackdropId(e.context),"data-state":i?"open":"closed"})},getPositionerProps(){return t.element({...p.positioner.attrs,dir:e.context.dir,id:r.getPositionerId(e.context),style:{pointerEvents:i?void 0:"none"}})},getContentProps(){return t.element({...p.content.attrs,dir:e.context.dir,role:e.context.role,hidden:!i,id:r.getContentId(e.context),tabIndex:-1,"data-state":i?"open":"closed","aria-modal":!0,"aria-label":n||void 0,"aria-labelledby":n||!a.title?void 0:r.getTitleId(e.context),"aria-describedby":a.description?r.getDescriptionId(e.context):void 0})},getTitleProps(){return t.element({...p.title.attrs,dir:e.context.dir,id:r.getTitleId(e.context)})},getDescriptionProps(){return t.element({...p.description.attrs,dir:e.context.dir,id:r.getDescriptionId(e.context)})},getCloseTriggerProps(){return t.button({...p.closeTrigger.attrs,dir:e.context.dir,id:r.getCloseTriggerId(e.context),type:"button",onClick(s){s.defaultPrevented||(s.stopPropagation(),o("CLOSE"))}})}}}function Q(e){const o=G(e);return I({id:"dialog",initial:o.open?"open":"closed",context:{role:"dialog",renderedElements:{title:!0,description:!0},modal:!0,trapFocus:!0,preventScroll:!0,closeOnInteractOutside:!0,closeOnEscape:!0,restoreFocus:!0,...o},created:["checkInitialFocusEl"],watch:{open:["toggleVisibility"]},states:{open:{entry:["checkRenderedElements","syncZIndex"],activities:["trackDismissableElement","trapFocus","preventScroll","hideContentBelow"],on:{"CONTROLLED.CLOSE":{target:"closed",actions:["setFinalFocus"]},CLOSE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose","setFinalFocus"]}],TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose","setFinalFocus"]}]}},closed:{on:{"CONTROLLED.OPEN":{target:"open"},OPEN:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen"]}],TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen"]}]}}}},{guards:{isOpenControlled:t=>!!t["open.controlled"]},activities:{trackDismissableElement(t,n,{send:i}){return N(()=>r.getContentEl(t),{defer:!0,pointerBlocking:t.modal,exclude:[r.getTriggerEl(t)],onInteractOutside(s){var d;(d=t.onInteractOutside)==null||d.call(t,s),(!t.closeOnInteractOutside||t.role==="alertdialog")&&s.preventDefault()},persistentElements:t.persistentElements,onFocusOutside:t.onFocusOutside,onPointerDownOutside:t.onPointerDownOutside,onEscapeKeyDown(s){var d;(d=t.onEscapeKeyDown)==null||d.call(t,s),t.closeOnEscape?i({type:"CLOSE",src:"escape-key"}):s.preventDefault()},onDismiss(){i({type:"CLOSE",src:"interact-outside"})}})},preventScroll(t){if(t.preventScroll)return j(r.getDoc(t))},trapFocus(t){if(!t.trapFocus||!t.modal)return;let n;const i=y(()=>{const a=r.getContentEl(t);if(a){n=$(a,{document:r.getDoc(t),escapeDeactivates:!1,preventScroll:!0,returnFocusOnDeactivate:!1,fallbackFocus:a,allowOutsideClick:!0,initialFocus:k({root:a,getInitialEl:t.initialFocusEl})});try{n.activate()}catch{}}});return()=>{n==null||n.deactivate(),i()}},hideContentBelow(t){return t.modal?L(()=>[r.getContentEl(t)],{defer:!0}):void 0}},actions:{checkInitialFocusEl(t){!t.initialFocusEl&&t.role==="alertdialog"&&(t.initialFocusEl=()=>r.getCloseTriggerEl(t))},checkRenderedElements(t){P(()=>{t.renderedElements.title=!!r.getTitleEl(t),t.renderedElements.description=!!r.getDescriptionEl(t)})},syncZIndex(t){P(()=>{const n=r.getContentEl(t);if(!n)return;const a=r.getWin(t).getComputedStyle(n);[r.getPositionerEl(t),r.getBackdropEl(t)].forEach(d=>{d==null||d.style.setProperty("--z-index",a.zIndex)})})},invokeOnClose(t){var n;(n=t.onOpenChange)==null||n.call(t,{open:!1})},invokeOnOpen(t){var n;(n=t.onOpenChange)==null||n.call(t,{open:!0})},toggleVisibility(t,n,{send:i}){i({type:t.open?"CONTROLLED.OPEN":"CONTROLLED.CLOSE",previousEvent:n})},setFinalFocus(t){t.restoreFocus&&queueMicrotask(()=>{var i;const n=((i=t.finalFocusEl)==null?void 0:i.call(t))??r.getTriggerEl(t);n==null||n.focus({preventScroll:!0})})}}})}T()(["aria-label","closeOnEscape","closeOnInteractOutside","dir","finalFocusEl","getRootNode","getRootNode","id","id","ids","initialFocusEl","modal","onEscapeKeyDown","onFocusOutside","onInteractOutside","onOpenChange","onPointerDownOutside","open.controlled","open","persistentElements","preventScroll","restoreFocus","role","trapFocus"]);const U=(e={})=>{const{getRootNode:o}=K(),{dir:t}=M(),n={id:g.useId(),getRootNode:o,dir:t,open:e.defaultOpen,"open.controlled":e.open!==void 0,...e},i={...n,open:e.open,onOpenChange:E(e.onOpenChange,{sync:!0}),onEscapeKeyDown:E(e.onEscapeKeyDown),onInteractOutside:E(e.onInteractOutside)},[a,s]=F(Q(n),{context:i});return J(a,s,b)},ce=e=>{const[o,{children:t,...n}]=B(e),[i]=R(o),a=U(n),s=C(c({present:a.open},o));return l.jsx(A,{value:a,children:l.jsx(S,{value:i,children:l.jsx(w,{value:s,children:t})})})},X=g.forwardRef((e,o)=>{const t=m(),n=c(t.getTitleProps(),e);return l.jsx(u.h2,{...n,ref:o})});X.displayName="DialogTitle";const Y=g.forwardRef((e,o)=>{const t=m(),n=O(),i=c({...t.getTriggerProps(),"aria-controls":n.unmounted?void 0:t.getTriggerProps()["aria-controls"]},e);return l.jsx(u.button,{...i,ref:o})});Y.displayName="DialogTrigger";export{Y as D,V as a,W as b,q as c,X as d,H as e,Z as f,ce as g};
