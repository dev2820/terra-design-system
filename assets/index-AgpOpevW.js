import{d as v,g as X,r as g,t as M,e as b,u as x,f as P,w as F,x as H}from"./factory-DwUv65Y6.js";import{a as k,q as N,f as I,i as K}from"./index-DHe2XY-8.js";import{e as S,f as W,w as Y}from"./index-D5jZQDUh.js";function U(e){const t={each(r){var s;for(let i=0;i<((s=e.frames)==null?void 0:s.length);i+=1){const n=e.frames[i];n&&r(n)}},queueBeforeEvent(r,s){const i=new Set;return t.each(n=>{try{i.add(N(n.document,r,s))}catch{}}),()=>{try{i.forEach(n=>n())}catch{}}},addEventListener(r,s,i){return t.each(n=>{try{n.document.addEventListener(r,s,i)}catch{}}),()=>{try{t.removeEventListener(r,s,i)}catch{}}},removeEventListener(r,s,i){t.each(n=>{try{n.document.removeEventListener(r,s,i)}catch{}})}};return t}var D="pointerdown.outside",T="focus.outside";function j(e){for(const t of e)if(x(t)&&M(t))return!0;return!1}var _=e=>"clientY"in e;function z(e,t){if(!_(t)||!e)return!1;const r=e.getBoundingClientRect();return r.width===0||r.height===0?!1:r.top<=t.clientY&&t.clientY<=r.top+r.height&&r.left<=t.clientX&&t.clientX<=r.left+r.width}function R(e){const t=b(e);if(!t||!_(e))return!1;const s=t.scrollHeight>t.clientHeight&&e.clientX>t.clientWidth,n=t.scrollWidth>t.clientWidth&&e.clientY>t.clientHeight;return s||n}function V(e,t){const{exclude:r,onFocusOutside:s,onPointerDownOutside:i,onInteractOutside:n,defer:p}=t;if(!e)return;const E=v(e),w=X(e),m=U(w);function B(c){const l=b(c);return!x(l)||P(e,l)||z(e,c)||R(c)?!1:!(r!=null&&r(l))}const y=new Set;function a(c){function l(){var O;const h=p?g:L=>L(),q=((O=c.composedPath)==null?void 0:O.call(c))??[c.target];h(()=>{if(!(!e||!B(c))){if(i||n){const L=S(i,n);e.addEventListener(D,L,{once:!0})}I(e,D,{bubbles:!1,cancelable:!0,detail:{originalEvent:c,contextmenu:K(c),focusable:j(q)}})}})}c.pointerType==="touch"?(y.forEach(h=>h()),y.add(N(E,"pointerup",l)),y.add(m.queueBeforeEvent("pointerup",l))):l()}const o=new Set,f=setTimeout(()=>{o.add(m.addEventListener("pointerdown",a,!0)),o.add(k(E,"pointerdown",a,!0))},0);function d(c){(p?g:h=>h())(()=>{if(!(!e||!B(c))){if(s||n){const h=S(s,n);e.addEventListener(T,h,{once:!0})}I(e,T,{bubbles:!1,cancelable:!0,detail:{originalEvent:c,contextmenu:!1,focusable:M(b(c))}})}})}return o.add(k(E,"focusin",d,!0)),o.add(m.addEventListener("focusin",d,!0)),()=>{clearTimeout(f),y.forEach(c=>c()),o.forEach(c=>c())}}function $(e,t){const{defer:r}=t,s=r?g:n=>n(),i=[];return i.push(s(()=>{const n=typeof e=="function"?e():e;i.push(V(n,t))})),()=>{i.forEach(n=>n==null?void 0:n())}}function G(e,t){const r=s=>{s.key==="Escape"&&(s.isComposing||t==null||t(s))};return k(v(e),"keydown",r,{capture:!0})}var u={layers:[],branches:[],count(){return this.layers.length},pointerBlockingLayers(){return this.layers.filter(e=>e.pointerBlocking)},topMostPointerBlockingLayer(){return[...this.pointerBlockingLayers()].slice(-1)[0]},hasPointerBlockingLayer(){return this.pointerBlockingLayers().length>0},isBelowPointerBlockingLayer(e){var s;const t=this.indexOf(e),r=this.topMostPointerBlockingLayer()?this.indexOf((s=this.topMostPointerBlockingLayer())==null?void 0:s.node):-1;return t<r},isTopMost(e){const t=this.layers[this.count()-1];return(t==null?void 0:t.node)===e},getNestedLayers(e){return Array.from(this.layers).slice(this.indexOf(e)+1)},isInNestedLayer(e,t){return this.getNestedLayers(e).some(r=>P(r.node,t))},isInBranch(e){return Array.from(this.branches).some(t=>P(t,e))},add(e){const t=this.layers.push(e);e.node.style.setProperty("--layer-index",`${t}`)},addBranch(e){this.branches.push(e)},remove(e){const t=this.indexOf(e);t<0||(t<this.count()-1&&this.getNestedLayers(e).forEach(s=>s.dismiss()),this.layers.splice(t,1),e.style.removeProperty("--layer-index"))},removeBranch(e){const t=this.branches.indexOf(e);t>=0&&this.branches.splice(t,1)},indexOf(e){return this.layers.findIndex(t=>t.node===e)},dismiss(e){var t;(t=this.layers[this.indexOf(e)])==null||t.dismiss()},clear(){this.remove(this.layers[0].node)}},A;function C(){u.layers.forEach(({node:e})=>{e.style.pointerEvents=u.isBelowPointerBlockingLayer(e)?"none":"auto"})}function J(e){e.style.pointerEvents=""}function Q(e,t){const r=v(e),s=[];if(u.hasPointerBlockingLayer()&&!r.body.hasAttribute("data-inert")&&(A=document.body.style.pointerEvents,queueMicrotask(()=>{r.body.style.pointerEvents="none",r.body.setAttribute("data-inert","")})),t){const i=F(t,n=>{s.push(H(n,{pointerEvents:"auto"}))});s.push(i)}return()=>{u.hasPointerBlockingLayer()||(queueMicrotask(()=>{r.body.style.pointerEvents=A,r.body.removeAttribute("data-inert"),r.body.style.length===0&&r.body.removeAttribute("style")}),s.forEach(i=>i()))}}function Z(e,t){if(!e){Y("[@zag-js/dismissable] node is `null` or `undefined`");return}const{onDismiss:r,pointerBlocking:s,exclude:i,debug:n}=t,p={dismiss:r,node:e,pointerBlocking:s};u.add(p),C();function E(a){var f,d;const o=b(a.detail.originalEvent);u.isBelowPointerBlockingLayer(e)||u.isInBranch(o)||((f=t.onPointerDownOutside)==null||f.call(t,a),(d=t.onInteractOutside)==null||d.call(t,a),!a.defaultPrevented&&(n&&console.log("onPointerDownOutside:",a.detail.originalEvent),r==null||r()))}function w(a){var f,d;const o=b(a.detail.originalEvent);u.isInBranch(o)||((f=t.onFocusOutside)==null||f.call(t,a),(d=t.onInteractOutside)==null||d.call(t,a),!a.defaultPrevented&&(n&&console.log("onFocusOutside:",a.detail.originalEvent),r==null||r()))}function m(a){var o;u.isTopMost(e)&&((o=t.onEscapeKeyDown)==null||o.call(t,a),!a.defaultPrevented&&r&&(a.preventDefault(),r()))}function B(a){var c;if(!e)return!1;const o=typeof i=="function"?i():i,f=Array.isArray(o)?o:[o],d=(c=t.persistentElements)==null?void 0:c.map(l=>l()).filter(x);return d&&f.push(...d),f.some(l=>P(l,a))||u.isInNestedLayer(e,a)}const y=[s?Q(e,t.persistentElements):void 0,G(e,m),$(e,{exclude:B,onFocusOutside:w,onPointerDownOutside:E,defer:t.defer})];return()=>{u.remove(e),C(),J(e),y.forEach(a=>a==null?void 0:a())}}function ne(e,t){const{defer:r}=t,s=r?g:n=>n(),i=[];return i.push(s(()=>{const n=W(e)?e():e;i.push(Z(n,t))})),()=>{i.forEach(n=>n==null?void 0:n())}}function se(e,t={}){const{defer:r}=t,s=r?g:n=>n(),i=[];return i.push(s(()=>{const n=W(e)?e():e;if(!n){Y("[@zag-js/dismissable] branch node is `null` or `undefined`");return}u.addBranch(n),i.push(()=>{u.removeBranch(n)})})),()=>{i.forEach(n=>n==null?void 0:n())}}export{ne as a,se as t};
